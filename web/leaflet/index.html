<!DOCTYPE html>
<html lang="sv">

<head>
    <meta charset="UTF-8">
    <title>Market</title>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css"
        integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
        crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"
        integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og=="
        crossorigin=""></script>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <header>
        <h1>Matmarknaden</h1>
    </header>
    <div id="mapid"></div>
    <script src="js/mapApp.js"></script>
</body>

</html>

<style>
    #mapid { height: 300px; }
</style>

<script>

    var mapApp = (function () {

            var mymap = L.map('mapid');

            function init() {
                mymap.locate({
                    setView: true,
                    maxZoom: 20
                });

                L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
                    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
                    maxZoom: 500,
                    id: 'mapbox/streets-v11',
                    accessToken: 'pk.eyJ1IjoieGN5bmljIiwiYSI6ImNrM3hpNzRzNzE2ZXkza2xrMDQ2NzM2c2EifQ.M-GV_EkiGgUPTuLFYXGQyA'
                }).addTo(mymap);

                mymap.on('locationfound', positionFound);
                mymap.on('locationerror', positionNotFound);

                addMarkers();

            }
            var myPosition;
            function positionFound(e) {
                myPosition = L.marker(e.latlng, {
                }).addTo(mymap);
            }

            function positionNotFound(e) {
                alert(e.message);
            }

            function addMarkers() {

                var myPlace = L.marker([59.32, 18.06]).bindPopup('Place').addTo(mymap);

                alert(myPlace.getLatLng());
                alert(myPosition.getLatLng()); // <- undefined

                //What i need (psuedo code-ish)
                /*
                var to = myPlace.getLatLng();
                var from = myPosition.getLatLng();
                var dist = from.distanceTo(to);      
                alert(distance);  // not really what I want but just for output..
                */


            };



            return {
                init: init
            };

        })();

        mapApp.init(); // Run application

</script>